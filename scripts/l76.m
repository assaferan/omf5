l_ap := [
    [2,0],
    [3, -7],
[5, 0],
[7, -3],
[11, -8],
[13, -17],
[17, 53],
[19, -(-32+1)],
[23, 5],
[29, 7],
[31, 68],
[37, -208],
[41, -252],
[43, 28],
[47, 648],
[53, 211],
[59, 205],
[61, 28],
[67, -275],
[71, -936],
[73, -21],
[79, 1140],
[83, 294],
[89, 108],
[97, 742],
[101, -2596],
[103, 372],
[107, -1341],
[109, -219],
[113, 182],
[127, -2346],
[131, 772],
[137, 21],
[139, 718],
[149, 1632],
[151, 1346],
[157, 3218],
[163, -2674],
[167, 22],
[173, 4656],
[179, 606],
[181, -1776],
[191, -1503],
[193, 2520],
[197, -1352],
[199, 4913],
[211, -415],
[223, -2692],
[227, -219],
[229, 1752],
[233, -3996],
[239, 933],
[241, -1544],
[251, -10394],
[257, -2288],
[263, 500],
[269, -1808],
[271, 233],
[277, 1554],
[281, 490],
[283, -5054],
[293, -2371]
];

l_ap2 = [
[2, 0],
[3, -2],
[5, -24],
[7, -28],
[11, -108],
[13, -110],
[17, -174]
];

ap_dict := [AssociativeArray() : i in [1,2]];

for ap in l_ap do
    ap_dict[1][ap[1]] := ap[2];
end for;

for ap in l_ap2 do
    ap_dict[2][ap[1]] := ap[2];
end for;

function local_factor(p,d)
    Zx<x> := PowerSeriesRing(Integers());
    if (p eq 2) then
	return 1+5*x+8*x^2;
    end if;
    ap := ap_dict[1][p];
    if (d le 1) then
	return 1-ap*x+O(x^2);
    end if;
    ap2 := ap_dict[2][p];
    return 1 - ap * x + p*(ap2+1+p^2) * x^2 - ap*p^3*x^3 + p^6*x^4;
end function;

lser := LSeries(4, [-1,0,0,1], 76, local_factor : Precision := 10);
